(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{4905:(e,s,r)=>{"use strict";r.d(s,{A:()=>d});var t=r(5155),a=r(2115),l=r(5112),n=r(6874),i=r.n(n),o=r(5956);function d(){let{user:e,signOut:s}=(0,l.A)(),[r,n]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),m=async()=>{await s(),c(!1)};return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:()=>{e?c(!d):n(!0)},className:"flex items-center text-gray-700 hover:text-gray-900 focus:outline-none",children:e?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white",children:e.name?e.name.charAt(0).toUpperCase():"U"}),(0,t.jsx)("span",{className:"ml-2 hidden md:block",children:e.name||e.email}),(0,t.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:d?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"})})]}):(0,t.jsx)("span",{className:"text-blue-600 hover:text-blue-800",children:"Sign In"})}),d&&(0,t.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10",children:(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsx)(i(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>c(!1),children:"Profile"}),(0,t.jsx)("button",{onClick:m,className:"w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Sign Out"})]})}),r&&(0,t.jsx)(o.A,{onClose:()=>n(!1)})]})}},5112:(e,s,r)=>{"use strict";r.d(s,{O:()=>c,A:()=>m});var t=r(5155),a=r(2115),l=r(5695),n=r(3464);let i=(0,r(851).UU)("https://zfodljvahdxaaihgtcfo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpmb2RsanZhaGR4YWFpaGd0Y2ZvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0NDg1MjQsImV4cCI6MjA2MDAyNDUyNH0.m24K7-5fJ33jw9ZR-SA2-ZOxrB5xRBu3ZKDoYh2ndn8"),o=(0,a.createContext)(void 0),d=["/dashboard","/posts","/profile"];function c(e){let{children:s}=e,[r,c]=(0,a.useState)(null),[m,u]=(0,a.useState)(!0),x=(0,l.useRouter)(),h=(0,l.usePathname)();(0,a.useEffect)(()=>{u(!0);let e=localStorage.getItem("authUser");if(e)try{c(JSON.parse(e))}catch(e){console.error("Error parsing saved user:",e),localStorage.removeItem("authUser")}u(!1)},[]),(0,a.useEffect)(()=>{!d.some(e=>null==h?void 0:h.startsWith(e))||m||r||x.push("/")},[h,m,r,x]);let g=async(e,s)=>{try{u(!0);let r=await n.A.post("/api/auth/signin",{email:e,password:s}),t=r.data;if(r.data.user)c(r.data.user),localStorage.setItem("authUser",JSON.stringify(r.data.user)),await i.auth.setSession({access_token:t.session.access_token,refresh_token:t.session.refresh_token});else throw Error("Invalid credentials");return}catch(e){throw console.error("Error signing in:",e),e}finally{u(!1)}},p=async(e,s,r)=>{try{u(!0);let t=await n.A.post("/api/auth/signup",{email:e,password:s,name:r||e.split("@")[0]});if(t.data.success)return{success:!0};return{success:!1,error:t.data.error||"Registration failed"}}catch(e){var t,a;return console.error("Error signing up:",e),{success:!1,error:(null==(a=e.response)||null==(t=a.data)?void 0:t.error)||e.message||"Registration failed"}}finally{u(!1)}},b=async()=>{try{c(null),localStorage.removeItem("authUser"),x.push("/")}catch(e){throw console.error("Error signing out:",e),e}};return(0,t.jsx)(o.Provider,{value:{user:r,isLoading:m,signIn:g,signUp:p,signOut:b,isAuthenticated:!!r},children:s})}function m(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5298:(e,s,r)=>{Promise.resolve().then(r.bind(r,8591))},5956:(e,s,r)=>{"use strict";r.d(s,{A:()=>n});var t=r(5155),a=r(2115),l=r(5112);function n(e){let{onClose:s}=e,[r,n]=(0,a.useState)("login"),[i,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),[x,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),{signIn:y,signUp:j}=(0,l.A)(),N=async e=>{e.preventDefault(),h(!0),p(""),f("");try{if("login"===r)await y(i,d),console.log("User logged in successfully"),s();else{let{success:e,error:s}=await j(i,d,m);if(console.log("Registration result:",{success:e,signUpError:s}),!e)return void p(s||"Registration failed. Please try again.");f("Registration successful! You can now sign in with your credentials."),o(""),c(""),u("")}}catch(e){console.error("Authentication error:",e),p(e.message||"Authentication failed. Please try again.")}finally{h(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"login"===r?"Sign In":"Create Account"}),(0,t.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:(0,t.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"flex border-b mb-4",children:[(0,t.jsx)("button",{className:"py-2 px-4 ".concat("login"===r?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"),onClick:()=>n("login"),children:"Sign In"}),(0,t.jsx)("button",{className:"py-2 px-4 ".concat("register"===r?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"),onClick:()=>n("register"),children:"Register"})]}),g&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:g}),b&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:b}),(0,t.jsxs)("form",{onSubmit:N,children:["register"===r&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-gray-700 mb-2",children:"Name"}),(0,t.jsx)("input",{type:"text",id:"name",value:m,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Your name"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-gray-700 mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",id:"email",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",required:!0})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-gray-700 mb-2",children:"Password"}),(0,t.jsx)("input",{type:"password",id:"password",value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"••••••••",required:!0})]}),(0,t.jsx)("button",{type:"submit",disabled:x,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:x?"Please wait...":"login"===r?"Sign In":"Create Account"})]})]})})}},8591:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>c});var t=r(5155),a=r(2115),l=r(5695),n=r(6874),i=r.n(n),o=r(5112),d=r(4905);function c(){let{user:e,isLoading:s}=(0,o.A)(),[r,n]=(0,a.useState)(""),[c,m]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[h,g]=(0,a.useState)(!1),p=(0,l.useRouter)();(0,a.useEffect)(()=>{e&&n(e.name||"")},[e]),(0,a.useEffect)(()=>{s||e||p.push("/dashboard")},[e,s,p]);let b=async s=>{s.preventDefault(),g(!0),m(""),x("");try{let s={...e,name:r};localStorage.setItem("authUser",JSON.stringify(s)),m("Profile updated successfully")}catch(e){console.error("Error updating profile:",e),x(e.message||"Failed to update profile")}finally{g(!1)}};return s?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading profile..."})]})}):e?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i(),{href:"/dashboard",className:"text-gray-500 hover:text-gray-700 mr-4",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile"})]}),(0,t.jsx)("div",{children:(0,t.jsx)(d.A,{})})]})}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c&&(0,t.jsx)("div",{className:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:c}),u&&(0,t.jsx)("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:u}),(0,t.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,t.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,t.jsx)("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"User Profile"}),(0,t.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Personal details and preferences."})]}),(0,t.jsx)("div",{className:"border-t border-gray-200",children:(0,t.jsxs)("dl",{children:[(0,t.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"User ID"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.id})]}),(0,t.jsxs)("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Email address"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.email})]}),(0,t.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:(0,t.jsxs)("form",{onSubmit:b,className:"flex items-center",children:[(0,t.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 mr-2",placeholder:"Enter your name"}),(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:h?"Saving...":"Update"})]})})]}),(0,t.jsxs)("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Created at"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.createdAt?new Date(e.createdAt).toLocaleString():"N/A"})]})]})})]})]})]}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[464,125,874,441,684,358],()=>s(5298)),_N_E=e.O()}]);