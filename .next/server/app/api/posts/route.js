"use strict";(()=>{var e={};e.id=607,e.ids=[607],e.modules={1708:e=>{e.exports=require("node:process")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:e=>{e.exports=require("node:tty")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{e.exports=require("punycode")},16698:e=>{e.exports=require("node:async_hooks")},27910:e=>{e.exports=require("stream")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31421:e=>{e.exports=require("node:child_process")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},37252:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>j,routeModule:()=>g,serverHooks:()=>m,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{DELETE:()=>f,GET:()=>x,POST:()=>h,PUT:()=>q});var o=t(96559),n=t(48088),a=t(37719),i=t(32190),u=t(61223),p=t(44999);let d=()=>(0,u.createServerComponentClient)({cookies:p.UL});var l=t(79688);async function c(e){let r=d();return console.log(await r.auth.getSession()),1}async function x(e){console.log("GET /api/posts route handler called");try{let r=e.headers.get("userId");if(console.log("Authenticated user ID:",r),!r)return i.NextResponse.json({error:"Authentication required"},{status:401});let t=await l.z.post.findMany({where:{userId:parseInt(r)},orderBy:{createdAt:"desc"}});return i.NextResponse.json({posts:t})}catch(e){return console.error("Error fetching posts:",e),i.NextResponse.json({error:"Failed to fetch posts"},{status:500})}}async function h(e){console.log("POST /api/posts route handler called");try{let r=await e.json();console.log("Request body:",r);let{title:t,description:s,imageUrl:o,status:n,scheduledFor:a}=r.formData,u=r.userId;if(!u)return i.NextResponse.json({error:"Authentication required"},{status:401});console.log("Creating post with data:",{title:t,description:s,imageUrl:o||"https://placehold.co/600x400",status:n||"draft",scheduledFor:a,userId:u});let p=await l.z.post.create({data:{title:t||"New Post",description:s||"New post description",imageUrl:o||"https://placehold.co/600x400",status:n||"draft",scheduledFor:a||null,userId:u}});return console.log("Post created:",p),i.NextResponse.json({message:"Post created successfully",post:p})}catch(e){return console.error("Error creating post:",e),console.error("Error details:",e.message),e.code&&console.error("Error code:",e.code),e.meta&&console.error("Error meta:",e.meta),i.NextResponse.json({error:"Failed to create post",details:e.message},{status:500})}}async function q(e){console.log("PUT /api/posts route handler called");try{let r=await c(e);if(!r)return i.NextResponse.json({error:"Authentication required"},{status:401});let t=await e.json();console.log("Request body:",t);let{id:s,title:o,description:n,imageUrl:a,status:u,scheduledFor:p}=t;if(!s)return i.NextResponse.json({error:"Post ID is required"},{status:400});let d=await l.z.post.findUnique({where:{id:s}});if(!d||d.userId!==r)return i.NextResponse.json({error:"Post not found or not authorized"},{status:403});let x=await l.z.post.update({where:{id:s},data:{title:o,description:n,imageUrl:a,status:u,scheduledFor:p}});return console.log("Post updated:",x),i.NextResponse.json({message:"Post updated successfully",post:x})}catch(e){return console.error("Error updating post:",e),i.NextResponse.json({error:"Failed to update post"},{status:500})}}async function f(e){console.log("DELETE /api/posts route handler called");try{let r=await c(e);if(!r)return i.NextResponse.json({error:"Authentication required"},{status:401});let t=new URL(e.url).searchParams.get("id");if(!t)return i.NextResponse.json({error:"Post ID is required"},{status:400});let s=parseInt(t),o=await l.z.post.findUnique({where:{id:s}});if(!o||o.userId!==r)return i.NextResponse.json({error:"Post not found or not authorized"},{status:403});return await l.z.post.delete({where:{id:s}}),console.log("Post deleted:",t),i.NextResponse.json({message:"Post deleted successfully"})}catch(e){return console.error("Error deleting post:",e),i.NextResponse.json({error:"Failed to delete post"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/posts/route",pathname:"/api/posts",filename:"route",bundlePath:"app/api/posts/route"},resolvedPagePath:"C:\\Users\\Hitesh Meshram\\Downloads\\t2\\t2\\my-app\\app\\api\\posts\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:y,serverHooks:m}=g;function j(){return(0,a.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:y})}},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48161:e=>{e.exports=require("node:os")},51455:e=>{e.exports=require("node:fs/promises")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},57975:e=>{e.exports=require("node:util")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{e.exports=require("node:fs")},74075:e=>{e.exports=require("zlib")},76760:e=>{e.exports=require("node:path")},77598:e=>{e.exports=require("node:crypto")},78474:e=>{e.exports=require("node:events")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},81630:e=>{e.exports=require("http")},91645:e=>{e.exports=require("net")},94735:e=>{e.exports=require("events")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[719,580,345,605,588],()=>t(37252));module.exports=s})();